(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-13bf3134"],{"5ccf":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.albumInfo.album?a("div",{staticClass:"album"},[a("div",{staticClass:"listInfo"},[a("div",{staticClass:"listAvatar"},[a("img",{attrs:{src:t.albumInfo.album.picUrl+"?param=300y300",alt:""}})]),a("div",{staticClass:"right"},[a("div",{staticClass:"title"},[a("div",{staticClass:"titleTag"},[t._v("专辑")]),a("div",{staticClass:"titleContent"},[t._v(t._s(t.albumInfo.album.name))])]),a("div",{staticClass:"buttons"},[a("div",{staticClass:"buttonItem playAll",on:{click:t.playAll}},[a("i",{staticClass:"iconfont icon-bofang playAll"}),a("span",[t._v("播放全部")])]),a("div",{staticClass:"buttonItem",on:{click:t.subAlbum}},[a("i",{staticClass:"iconfont icon-xihuan",class:t.isSub?"red":""}),a("span",[t._v(t._s(t.isSub?"已收藏":"收藏"))])]),t._m(0)]),a("div",{staticClass:"otherInfo"},[a("div",{staticClass:"playCount"},[t._v(" 歌手： "),a("span",{on:{click:function(e){return t.$router.push({name:"singerDetail",params:{id:t.albumInfo.album.artist.id}})}}},[t._v(t._s(t.albumInfo.album.artist.name))])])]),a("div",{staticClass:"otherInfo detail"},[a("span",[t._v("时间："+t._s(t._f("showDate")(t.albumInfo.album.publishTime)))])])])]),a("div",{staticClass:"musicList"},[a("el-tabs",{attrs:{value:"first"}},[a("el-tab-pane",{attrs:{label:"歌曲列表",name:"first"}},[a("el-table",{staticStyle:{width:"90%"},attrs:{data:t.albumInfo.songs,stripe:"",size:"mini","highlight-current-row":""},on:{"row-dblclick":t.clickRow,"cell-click":t.clickCell}},[a("el-table-column",{attrs:{type:"index",width:"30",label:"",index:t.handleIndex}}),a("el-table-column",{attrs:{label:"",width:"30"}},[a("i",{staticClass:"iconfont icon-download"})]),a("el-table-column",{attrs:{prop:"name",label:"音乐标题",width:"350"}}),a("el-table-column",{attrs:{prop:"ar[0].name",label:"歌手",width:"200"}}),a("el-table-column",{attrs:{prop:"al.name",label:"专辑",width:"240"}}),a("el-table-column",{attrs:{prop:"dt",label:"时长",width:"100"}})],1)],1),a("el-tab-pane",{attrs:{label:"评论",name:"second"}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isCommentLoading,expression:"isCommentLoading"}],staticClass:"commentList"},[t.comments.hotComments?a("comment",{attrs:{comments:t.comments.hotComments,commentType:"album",commentId:t.albumInfo.album.id+""},on:{getComment:t.getAlbumComment}},[a("div",{attrs:{slot:"title"},slot:"title"},[t._v("精彩评论")])]):t._e(),a("comment",{attrs:{comments:t.comments.comments,commentType:"album",commentId:t.albumInfo.album.id+"",isHotComment:!t.comments.hotComments},on:{getComment:t.getAlbumComment}},[a("div",{attrs:{slot:"title"},slot:"title"},[t._v("热门评论")])])],1),t.comments&&t.comments.comments?a("div",{staticClass:"page"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.comments.total,small:"","page-size":50,"current-page":t.currentCommentPage},on:{"current-change":t.commentPageChange}})],1):t._e()]),a("el-tab-pane",{attrs:{label:"专辑详情",name:"third"}},[a("div",{staticClass:"albumDesc"},[t._v(t._s(t.albumInfo.album.description))])])],1)],1),a("go-top",{attrs:{scrollObj:".album"}})],1):t._e()},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"buttonItem"},[a("i",{staticClass:"iconfont icon-zhuanfa"}),a("span",[t._v("分享")])])}],i=a("c7eb"),o=a("1da1"),c=(a("d3b7"),a("159b"),a("ac1f"),a("466d"),a("fb6a"),a("b0c0"),a("7db0"),a("aa2a")),r=a("67f1"),l=a("7cff"),m={components:{Comment:r["a"],GoTop:l["a"]},name:"album",data:function(){return{albumInfo:{},isSub:!1,comments:{},currentCommentPage:1,isCommentLoading:!1}},methods:{getAlbumDetail:function(){var t=this;return Object(o["a"])(Object(i["a"])().mark((function e(){var a;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$request("/album",{id:t.$route.params.id});case 2:a=e.sent,a=a.data,a.songs.forEach((function(t,e){a.songs[e].dt=Object(c["b"])(t.dt)})),t.albumInfo=a;case 6:case"end":return e.stop()}}),e)})))()},getAlbumComment:function(t){var e=this;return Object(o["a"])(Object(i["a"])().mark((function a(){var n,s,o,c;return Object(i["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=Date.parse(new Date),e.isCommentLoading=!0,"changePage"===t&&(s=document.querySelector(".album"),o=document.querySelector(".listInfo"),s.scrollTo({behavior:"smooth",top:o.clientHeight-25})),a.next=5,e.$request("/comment/album",{id:e.$route.params.id,offset:50*(e.currentCommentPage-1),limit:50,timestamp:n});case 5:if(c=a.sent,e.isCommentLoading=!1,200===c.data.code){a.next=10;break}return e.$message.error("获取评论失败,请稍后重试!"),a.abrupt("return");case 10:e.comments=c.data;case 11:case"end":return a.stop()}}),a)})))()},handleIndex:function(t){return t+=1,t<10?"0"+t:t},playAll:function(){this.$store.commit("updateMusicId",this.albumInfo.songs[0].id),this.$store.commit("updateMusicList",{musicList:this.albumInfo.songs,musicListId:this.albumInfo.album.id})},clickRow:function(t){this.$store.commit("updateMusicId",t.id),this.albumInfo.album.id!==this.$store.state.musicListId&&this.$store.commit("updateMusicList",{musicList:this.albumInfo.songs,musicListId:this.albumInfo.album.id})},commentPageChange:function(t){this.currentCommentPage=t,this.getAlbumComment("changePage")},subAlbum:function(){var t=this;return Object(o["a"])(Object(i["a"])().mark((function e(){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isSub=!t.isSub,e.next=3,t.$request("/album/sub",{id:t.$route.params.id,t:t.isSub?1:0});case 3:t.getAlbumSublist();case 4:case"end":return e.stop()}}),e)})))()},getAlbumSublist:function(){var t=this;return Object(o["a"])(Object(i["a"])().mark((function e(){var a,n;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=Date.parse(new Date),e.next=3,t.$request("/album/sublist",{limit:1e3,timestamp:a});case 3:n=e.sent,t.$store.commit("updateSubAlbumList",n.data.data);case 5:case"end":return e.stop()}}),e)})))()},clickCell:function(t,e,a){var n=this;return Object(o["a"])(Object(i["a"])().mark((function e(){var s,o,c,r,l;return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a.querySelector(".icon-download")){e.next=15;break}return e.next=3,n.$request("/song/url",{id:t.id});case 3:if(s=e.sent,null!=s.data.data[0].url){e.next=7;break}return n.$message.warning("暂时无法获取该资源哦!"),e.abrupt("return");case 7:if(o=s.data.data[0].url.match(/http.*?\.net/),c=o[0].match(/http:\/(\S*).music/)[1],"/m7"===c||"/m701"===c||"/m8"===c||"/m801"===c){e.next=12;break}return n.$message.error("匹配不到对应的代理,下载失败!"),e.abrupt("return");case 12:r=s.data.data[0].url.slice(o[0].length),l={url:c+r,name:t.name+" - "+t.ar[0].name+"."+s.data.data[0].type.toLowerCase()},n.$store.commit("updateDownloadMusicInfo",l);case 15:case"end":return e.stop()}}),e)})))()},getIsSub:function(){var t=this;this.isSub=this.$store.state.subAlbumList.find((function(e){return e.id===t.$route.params.id}))}},created:function(){this.getAlbumComment()},mounted:function(){var t=this;return Object(o["a"])(Object(i["a"])().mark((function e(){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getAlbumDetail();case 2:if(t.$nextTick((function(){t.$route.params.id===t.$store.state.musicListId&&t.handleDOM(t.$store.state.musicId)})),null!=t.$store.state.subAlbumList){e.next=6;break}return e.next=6,t.getAlbumSublist();case 6:t.getIsSub();case 7:case"end":return e.stop()}}),e)})))()},filters:{showDate:function(t){var e=new Date(t);return Object(c["a"])(e,"yyyy-MM-dd")},handleNum:c["c"]}},u=m,b=(a("c479"),a("2877")),d=Object(b["a"])(u,n,s,!1,null,"0354e955",null);e["default"]=d.exports},c479:function(t,e,a){"use strict";a("ef3a")},ef3a:function(t,e,a){}}]);
//# sourceMappingURL=chunk-13bf3134.2002b3f9.js.map