(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-13029846"],{"3a1b":function(e,t,a){},d1b9:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.videoUrl?a("div",{staticClass:"videoDetail"},[a("div",{staticClass:"left"},[a("div",{staticClass:"title"},[e._v(" "+e._s("mv"==e.$route.params.type?"MV详情":"视频详情")+" ")]),a("div",{staticClass:"videoShow"},[a("video",{attrs:{src:e.videoUrl,controls:"",width:"496px",height:"284px",poster:"mv"==e.$route.params.type?e.videoInfo.cover:e.videoInfo.coverUrl},on:{play:e.playVideo}})]),("mv"==e.$route.params.type?e.videoInfo.cover:e.videoInfo.coverUrl)?a("div",{staticClass:"videoInfo"},[a("div",{staticClass:"user"},[a("div",{staticClass:"avatar",on:{click:function(t){return e.goToPersonal()}}},[a("img",{attrs:{src:"mv"==e.$route.params.type?e.videoInfo.artists[0].img1v1Url:e.videoInfo.creator.avatarUrl,alt:""}})]),a("div",{staticClass:"userName",on:{click:function(t){return e.goToPersonal()}}},[e._v(" "+e._s("mv"==e.$route.params.type?e.videoInfo.artists[0].name:e.videoInfo.creator.nickname)+" ")])]),a("div",{staticClass:"videoTitle"},[e._v(e._s("mv"==e.$route.params.type?e.videoInfo.name:e.videoInfo.title))]),a("div",{staticClass:"otherInfo"},[a("div",[e._v(" 发布："+e._s(e._f("showDate")((e.$route.params.type,e.videoInfo.publishTime)))+" ")]),a("div",[e._v(" 播放："+e._s(e._f("handleNum")("mv"==e.$route.params.type?e.videoInfo.playCount:e.videoInfo.playTime))+" ")])]),a("div",{staticClass:"buttons"},[a("div",{staticClass:"buttonItem"},[a("i",{staticClass:"iconfont icon-good",class:e.isLike?"red":""}),e._v(" "+e._s(e.isLike?"已赞":"赞")+" ")]),a("div",{staticClass:"buttonItem"},[a("i",{staticClass:"iconfont icon-xihuan",class:e.isSub?"red":""}),e._v(" "+e._s(e.isSub?"已收藏":"收藏")+" ")]),e._m(0)])]):e._e(),a("div",{staticClass:"comment"},[a("div",{staticClass:"title commentTitle"},[e._v("评论")]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isCommentLoading,expression:"isCommentLoading"}],staticClass:"commentList"},[e.comments.hotComments?a("comment",{ref:"hotComments",attrs:{comments:e.comments.hotComments,commentType:"mv"==e.$route.params.type?"mv":"video",commentId:e.$route.params.id+""},on:{getComment:function(t){"mv"==e.$route.params.type?e.getMvComment():e.getVideoComment()},scrollToComment:e.scrollToComment}},[a("div",{attrs:{slot:"title"},slot:"title"},[e._v("精彩评论")])]):e._e(),a("comment",{attrs:{comments:e.comments.comments,commentType:"mv"==e.$route.params.type?"mv":"video",commentId:e.$route.params.id+"",isHotComment:!e.comments.hotComments},on:{getComment:function(t){"mv"==e.$route.params.type?e.getMvComment():e.getVideoComment()},scrollToComment:e.scrollToComment,transToHotComment:function(t){return e.$refs.hotComments.floorComment(t.commentId,t.nickName)}}},[a("div",{attrs:{slot:"title"},slot:"title"},[e._v("最新评论")])])],1)])]),a("div",{staticClass:"right"},[a("div",{staticClass:"title"},[e._v("相关推荐")]),e._l(e.relatedVideo,(function(t,i){return a("div",{key:i,staticClass:"relatedVideoItem",on:{click:function(a){return e.goToRelatedVideo(t.vid)}}},[a("div",{staticClass:"relatedVideoItemCover"},[a("img",{attrs:{src:t.coverUrl+"?param=300y180",alt:""}}),a("div",{staticClass:"relatedVideoItemPlayCount"},[a("i",{staticClass:"iconfont icon-shipin"}),e._v(" "+e._s(e._f("handleNum")(t.playTime))+" ")]),a("div",{staticClass:"relatedVideoItemTime"},[e._v(" "+e._s(e._f("handleMusicTime")(t.durationms))+" ")])]),a("div",{staticClass:"relatedVideoItemInfo"},[a("div",{staticClass:"relatedVideoItemTitle"},[e._v(e._s(t.title))]),a("div",{staticClass:"creator"},[e._v("by "+e._s(t.creator[0].userName))])])])}))],2),a("go-top",{attrs:{scrollObj:".videoDetail"}})],1):e._e()},s=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"buttonItem"},[a("i",{staticClass:"iconfont icon-zhuanfa"}),a("span",[e._v("分享")])])}],r=a("c7eb"),o=a("1da1"),n=(a("7db0"),a("d3b7"),a("a4d3"),a("e01a"),a("aa2a")),c=a("67f1"),m=a("7cff"),d={components:{Comment:c["a"],GoTop:m["a"]},name:"videoDetail",data:function(){return{videoInfo:{},videoUrl:"",relatedVideo:[],comments:{},commentsPage:1,isSub:!1,isCommentLoading:!1,isLike:!1}},methods:{getRelatedVideo:function(){var e=this;return Object(o["a"])(Object(r["a"])().mark((function t(){var a;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$request("/related/allvideo",{id:e.$route.params.id});case 2:a=t.sent,e.relatedVideo=a.data.data;case 4:case"end":return t.stop()}}),t)})))()},getVideoDetail:function(){var e=this;return Object(o["a"])(Object(r["a"])().mark((function t(){var a;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$request("/video/detail",{id:e.$route.params.id});case 2:a=t.sent,e.videoInfo=a.data.data;case 4:case"end":return t.stop()}}),t)})))()},getVideoUrl:function(){var e=this;return Object(o["a"])(Object(r["a"])().mark((function t(){var a;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$request("/video/url",{id:e.$route.params.id});case 2:a=t.sent,e.videoUrl=a.data.urls[0].url;case 4:case"end":return t.stop()}}),t)})))()},getMvDetail:function(){var e=this;return Object(o["a"])(Object(r["a"])().mark((function t(){var a;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$request("/mv/detail",{mvid:e.$route.params.id});case 2:a=t.sent,e.videoInfo=a.data.data;case 4:case"end":return t.stop()}}),t)})))()},getMvUrl:function(){var e=this;return Object(o["a"])(Object(r["a"])().mark((function t(){var a;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$request("/mv/url",{id:e.$route.params.id});case 2:a=t.sent,e.videoUrl=a.data.data.url;case 4:case"end":return t.stop()}}),t)})))()},getMvComment:function(){var e=this;return Object(o["a"])(Object(r["a"])().mark((function t(){var a,i;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=Date.parse(new Date),e.isCommentLoading=!0,t.next=4,e.$request("/comment/mv",{id:e.$route.params.id,offset:20*(e.commentsPage-1),timestamp:a});case 4:if(i=t.sent,200===i.data.code){t.next=8;break}return e.$message.error("获取评论失败,请稍后重试!"),t.abrupt("return");case 8:case"end":return t.stop()}}),t)})))()},scrollToComment:function(){var e=document.querySelector(".videoDetail"),t=document.querySelector(".commentTitle");e.scrollTo({behavior:"smooth",top:t.offsetTop-70})},getVideoComment:function(e){var t=this;return Object(o["a"])(Object(r["a"])().mark((function a(){var i,s,o,n;return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i=Date.parse(new Date),t.isCommentLoading=!0,"changePage"===e&&(s=document.querySelector(".videoDetail"),o=document.querySelector(".commentTitle"),s.scrollTo({behavior:"smooth",top:o.offsetTop-70})),a.next=5,t.$request("/comment/video",{id:t.$route.params.id,offset:20*(t.commentsPage-1),timestamp:i});case 5:if(n=a.sent,t.isCommentLoading=!1,200===n.data.code){a.next=10;break}return t.$message.error("获取评论失败,请稍后重试!"),a.abrupt("return");case 10:t.comments=n.data;case 11:case"end":return a.stop()}}),a)})))()},playVideo:function(){this.$store.commit("changePlayState",!1)},goToPersonal:function(){var e="mv"===this.$route.params.type?this.videoInfo.artists[0].id:this.videoInfo.creator.userId;"mv"===this.$route.params.type?this.$router.push({name:"singerDetail",params:{id:e}}):this.$router.push({name:"personal",params:{uid:e}})},goToRelatedVideo:function(e){this.$router.push({name:"videoDetail",params:{id:e,type:"video"}})},getIsSub:function(){var e=this;this.isSub=this.$store.state.subVideoList.find((function(t){return t.vid===e.$route.params.id}))},getIsLike:function(){var e=this;"mv"===this.$route.params.type?this.isLike=this.$store.state.likeVideoList.find((function(t){return t.mlogBaseData.id===e.$route.params.id})):this.isLike=this.$store.state.likeVideoList.find((function(t){return t.mlogBaseData.desc===e.videoInfo.description&&t.mlogBaseData.dration===e.videoInfo.durationms}))},likeVideo:function(){var e=this;return Object(o["a"])(Object(r["a"])().mark((function t(){var a,i;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isLike=!e.isLike,a=Date.parse(new Date),i="mv"===e.$route.params.type?1:5,t.next=5,e.$request("/resource/like",{type:i,id:e.$route.params.id,t:e.isLike?1:0,timestamp:a});case 5:t.sent,e.getLikeVideoList();case 7:case"end":return t.stop()}}),t)})))()},getLikeVideoList:function(){var e=this;return Object(o["a"])(Object(r["a"])().mark((function t(){var a,i;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=Date.parse(new Date),t.next=3,e.$request("/playlist/mylike",{limit:1e3,timestamp:a});case 3:if(i=t.sent,200===i.data.code){t.next=7;break}return e.$message.error("获取用户点赞视频失败,请稍后重试!"),t.abrupt("return");case 7:e.$store.commit("updateLikeVideoList",i.data.data.feeds);case 8:case"end":return t.stop()}}),t)})))()},getSubVideoList:function(){var e=this;return Object(o["a"])(Object(r["a"])().mark((function t(){var a,i;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=Date.parse(new Date),t.next=3,e.$request("/mv/sublist",{limit:1e3,timestamp:a});case 3:if(i=t.sent,200===i.data.code){t.next=7;break}return e.$message.error("获取用户收藏视频失败,请稍后重试!"),t.abrupt("return");case 7:e.$store.commit("updateSubVideoList",i.data.data);case 8:case"end":return t.stop()}}),t)})))()}},created:function(){var e=this;return Object(o["a"])(Object(r["a"])().mark((function t(){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.getRelatedVideo(),"mv"!==e.$route.params.type){t.next=8;break}return t.next=4,e.getMvDetail();case 4:e.getMvUrl(),e.getMvComment(),t.next=13;break;case 8:if("video"!==e.$route.params.type){t.next=13;break}return t.next=11,e.getVideoDetail();case 11:e.getVideoUrl(),e.getVideoComment();case 13:if(null!=e.$store.state.subVideoList){t.next=16;break}return t.next=16,e.getSubVideoList();case 16:if(e.getIsSub(),null!=e.$store.state.likeVideoList){t.next=20;break}return t.next=20,e.getLikeVideoList();case 20:e.getIsLike();case 21:case"end":return t.stop()}}),t)})))()},filters:{handleNum:n["c"],handleMusicTime:n["b"],showDate:function(e){var t=new Date(e);return Object(n["a"])(t,"yyyy-MM-dd")}},watch:{}},u=d,l=(a("d82e"),a("2877")),v=Object(l["a"])(u,i,s,!1,null,"263a8784",null);t["default"]=v.exports},d82e:function(e,t,a){"use strict";a("3a1b")}}]);
//# sourceMappingURL=chunk-13029846.4d40d8ba.js.map